<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Faraz Samie | Experience Page</title>
    <link rel="icon" href="images/icon.png" type="image/png">
    <link rel="stylesheet" href="experience.css"/>
    <!-- Load GSAP animation library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/CustomEase.min.js"></script>
</head>

<body>
    <div class="container">
        <nav>
            <a href="index.html" id="logo">Home</a>
            <a href="resume.html">Resume</a>
        </nav>

        <div class="slides"></div> <!-- Slide container -->
        <div class="slider-nav"></div> <!-- Navigation container -->
        <div class="slide-description"></div>

        <footer>
            <h2 id="title">EXPERIENCE</h2>
            <p>Faraz Samie 2024</p>
        </footer>
    </div>

    <div class="bg-overlay"></div> <!-- Overlay -->

    <!-- JavaScript code is now inline here -->
    <script>
        const titles = [
            ["Adidas", "Sales Associate at Adidas"],  
            ["Google", "Software Engineer at Google"],
            ["Tesla", "Engineer at Tesla"],
            ["Apple", "Product Manager at Apple"],
        ];

        document.addEventListener("DOMContentLoaded", function () {
            // Register GSAP plugin
            gsap.registerPlugin(CustomEase);

            // Create a custom easing function for animations
            CustomEase.create(
                "hop",
                "M0,0 C0.071,0.505 0.192,0.726 0.318,0.852 0.45,0.984 0.504,1 1,1"
            );

            // DOM Elements
            const sliderNav = document.querySelector(".slider-nav");
            const slidesContainer = document.querySelector(".slides");
            const bgOverlay = document.querySelector(".bg-overlay");
            const slideTitle = document.querySelector(".slide-title");

            // Dynamically set the number of items based on the titles array length
            const numberOfItems = titles.length;
            let currentIndex = 0;

            // Configurations for animation
            const ANIMATION_DURATION = 1.5;
            const LETTER_STAGGER_DELAY = 0.125;

            // Function to update the title letters on each slide
            function updateTitle(newIndex, color) {
                const title = titles[newIndex];
                const titleRows = slideTitle.querySelectorAll(".slide-title-row");

                titleRows.forEach((row, rowIndex) => {
                    row.querySelectorAll(".letter").forEach((letter, letterIndex) => {
                        const existingSpan = letter.querySelector("span");
                        if (existingSpan) {
                            letter.removeChild(existingSpan); // Remove old letter
                        }

                        const newSpan = document.createElement("span");
                        const direction = newIndex > currentIndex ? 150 : -150; // Slide direction

                        gsap.set(newSpan, {
                            x: direction,
                            color: color
                        });

                        newSpan.textContent = title[rowIndex]?.[letterIndex] || "";
                        letter.appendChild(newSpan);

                        gsap.to(newSpan, {
                            x: 0,
                            duration: 1,
                            ease: "hop",
                            delay: LETTER_STAGGER_DELAY
                        });
                    });
                });
            }

            // Function to create navigation items and slides dynamically
            function createSlidesAndNav() {
                titles.forEach((_, i) => {
                    // Create nav item
                    const navItemWrapper = document.createElement("div");
                    navItemWrapper.classList.add("nav-item-wrapper");
                    if (i === 0) navItemWrapper.classList.add("active"); // Set first item as active

                    const navItem = document.createElement("div");
                    navItem.classList.add("nav-item");

                    navItemWrapper.appendChild(navItem);
                    sliderNav.appendChild(navItemWrapper);

                    navItemWrapper.addEventListener("click", () => handleNavClick(i));

                    // Create slide
                    const slide = document.createElement("div");
                    slide.classList.add("slide");
                    if (i === 0) slide.classList.add("active");

                    const imgWrapper = document.createElement("div");
                    imgWrapper.classList.add("img");

                    const img = document.createElement("img");
                    img.src = `./images/img${i + 1}.jpg`;
                    img.alt = `Slide Image ${i + 1}`;

                    imgWrapper.appendChild(img);
                    slide.appendChild(imgWrapper);
                    slidesContainer.appendChild(slide);
                });
            }

            // Handle navigation clicks
            function handleNavClick(index) {
                if (index === currentIndex) return;

                document.querySelectorAll(".nav-item-wrapper").forEach((nav) => nav.classList.remove("active"));
                document.querySelectorAll(".nav-item-wrapper")[index].classList.add("active");

                const translateXValue = -index * 100;
                gsap.to(slidesContainer, {
                    x: `${translateXValue}vw`,
                    duration: ANIMATION_DURATION,
                    ease: "hop"
                });

                const newColor = getRandomColor();
                gsap.to(bgOverlay, {
                    backgroundColor: newColor,
                    duration: ANIMATION_DURATION,
                    ease: "hop"
                });

                updateTitle(index, newColor);
                currentIndex = index;
            }

            // Initialize: create slides and nav items, and set the initial title
            createSlidesAndNav();
            updateTitle(0, getComputedStyle(bgOverlay).backgroundColor);

            function getRandomColor() {
                return "#" + Math.floor(Math.random() * 16777215).toString(16);
            }
        });
    </script>
</body>
</html>
